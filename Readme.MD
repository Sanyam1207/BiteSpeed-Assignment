Bitespeed Identity Reconciliation API

This project implements an identity reconciliation system that links customer contacts across multiple purchases using email and phone number matching.

It ensures:
Consistent primary-secondary linking
Atomic database updates using transactions
Recursive cluster resolution
Production-ready architecture



Tech Stack

Node.js
Express
TypeScript
Prisma ORM
MySQL
Zod (Validation)
Express Rate Limiter



Project Structure
src/
â”‚
â”œâ”€â”€ config/         â†’ Environment & Prisma configuration
â”œâ”€â”€ controllers/    â†’ Handles HTTP requests & responses
â”œâ”€â”€ lib/            â†’ Shared utilities
â”œâ”€â”€ middlewares/    â†’ Rate limiting & validation middleware
â”œâ”€â”€ repository/     â†’ Direct database interaction layer
â”œâ”€â”€ routes/         â†’ API route definitions
â”œâ”€â”€ services/       â†’ Core business logic (identity reconciliation)
â”œâ”€â”€ validators/     â†’ Zod schema validation
â””â”€â”€ server.ts       â†’ Entry point



Architecture Highlights
ğŸ”¹ Clean Layered Architecture
Controller â†’ Service â†’ Repository â†’ DB
Separation of concerns maintained


ğŸ”¹ Transaction Support
All reconciliation logic is wrapped inside Prisma transactions to ensure atomicity.
If any step fails:
No partial updates occur
Database consistency is maintained


ğŸ”¹ Recursive Cluster Resolution
Contacts are treated as a graph structure.
A BFS-based traversal ensures complete cluster resolution across multi-level linked contacts.


ğŸ”¹ Security
Rate limiting enabled
Input validation using Zod


ğŸ”¹ API Endpoint
POST /identify
Request Body

Request : 
{
  "email": "string (optional)",
  "phoneNumber": "string (optional)"
}


Response Format:
{
  "contact": {
    "primaryContactId": 1,
    "emails": ["primary@email.com", "secondary@email.com"],
    "phoneNumbers": ["123456", "999999"],
    "secondaryContactIds": [2, 3]
  }
}



ğŸ§ª Testing Examples
1ï¸âƒ£ New User
{
  "email": "lorraine@hillvalley.edu",
  "phoneNumber": "123456"
}
2ï¸âƒ£ Secondary Creation
{
  "email": "mcfly@hillvalley.edu",
  "phoneNumber": "123456"
}
3ï¸âƒ£ Primary Merge Case
{
  "email": "george@hillvalley.edu",
  "phoneNumber": "717171"
}



âš™ï¸ Local Setup
git clone <repo-url>
npm install
npx prisma migrate dev
npm run dev

Server runs on:

http://localhost:3000






__________________________________________________________________________________

Bhai simple language me bataun toh ğŸ‘‡

Ye project ek identity reconciliation system hai.

Matlab agar ek customer alag alag email aur phone se order kare,
toh system unko intelligently link karega.

Structure clean rakha hai:

Controller â†’ Service â†’ Repository â†’ DB

Service layer me pura dimaag laga hai:

Recursive graph traversal

Primary-secondary linking

Merge handling

Idempotency

Transactions for safety

Sab DB operations transaction me wrapped hain.
Matlab agar beech me error aaye toh kuch bhi half update nahi hoga.

Validation Zod se ki hai.
Rate limiter bhi lagaya hai.
Indexes bhi add kiye hai performance ke liye.

Endpoint sirf ek hai:

POST /identify

Body me email ya phone bhejo.
Response me consolidated contact milta hai.

Deployment Render pe kiya hai.
Production ready architecture follow kiya hai.